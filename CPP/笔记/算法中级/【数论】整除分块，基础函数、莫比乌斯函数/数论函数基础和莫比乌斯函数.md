### 数论函数与狄利克雷卷积

#### 1. 约数和函数
约数和函数 \( \sigma(n) \) 定义为正整数 \( n \) 所有正约数的和，即：
\[
\sigma(n) = \sum_{d \mid n} d
\]


#### 2. 狄利克雷卷积
若 \( f(n) \)、\( g(n) \) 均为数论函数，则它们的**狄利克雷卷积**定义为：
\[
h(n) = f(n) * g(n) = \sum_{d \mid n} f(d) g\left( \frac{n}{d} \right) = \sum_{d \mid n} f\left( \frac{n}{d} \right) g(d)
\]
狄利克雷卷积满足：
- **交换律**：\( f * g = g * f \)
- **结合律**：\( f * (g * h) = (f * g) * h \)
- **分配律**：\( (f + g) * h = f * h + g * h \)


#### 3. 常用数论函数与卷积关系
以下是数论中常见的函数及其通过狄利克雷卷积的关联：

| 函数符号 | 函数名称       | 定义                                  | 卷积关系示例                     |
|----------|----------------|---------------------------------------|----------------------------------|
| \( \varepsilon \) | 单位函数       | \( \varepsilon(n) = \begin{cases} 1, & n=1 \\ 0, & n \neq 1 \end{cases} \) | \( \varepsilon = I * \mu \)（即 \( \varepsilon(n) = \sum_{d \mid n} \mu(d) \)） |
| \( I \)   | 常数函数       | \( I(n) = 1 \)                        | \( \sigma = I * \text{Id} \)（即 \( \sigma(n) = \sum_{d \mid n} d \)） |
| \( \text{Id} \) | 恒等函数       | \( \text{Id}(n) = n \)                | \( \varphi = \text{Id} * \mu \)（即 \( \varphi(n) = \sum_{d \mid n} \mu(d) \cdot \frac{n}{d} \)） |
| \( \mu \) | 莫比乌斯函数   | 若 \( n \) 含平方因子则 \( \mu(n)=0 \)；否则 \( \mu(n)=(-1)^k \)（\( k \) 为质因子个数） | 核心用于反演，如 \( \varepsilon = I * \mu \) |
| \( \varphi \) | 欧拉函数       | \( \varphi(n) \) 为小于 \( n \) 且与 \( n \) 互质的数的个数 | \( \varphi = \text{Id} * \mu \)，且 \( \sum_{d \mid n} \varphi(d) = n \) |


#### 4. 积性函数的性质
数论函数的“积性”是核心性质，分为两类：
- **完全积性**：对任意正整数 \( p, q \)，有 \( f(pq) = f(p) \cdot f(q) \)。例如 \( \varepsilon, I, \text{Id} \) 均为完全积性函数。
- **积性**：仅当 \( \gcd(p, q) = 1 \) 时，有 \( f(pq) = f(p) \cdot f(q) \)。例如 \( \mu, \varphi, \sigma \) 均为积性函数（非完全积性）。

### 莫比乌斯函数与反演

#### 1. 莫比乌斯函数定义
莫比乌斯函数 \( \mu(x) \) 是数论中的核心函数，定义如下（\( x \in \mathbb{Z}^+ \)）：
\[
\mu(x) =
\begin{cases}
1, & x = 1 \\
(-1)^k, & x \text{ 是无平方因子数，且 } k \text{ 为 } x \text{ 的质因子个数} \\
0, & x \text{ 含平方因子（即存在质数 } p \text{ 使 } p^2 \mid x \text{）}
\end{cases}
\]
- 示例：
  - \( x = 6 = 2 \times 3 \)（无平方因子，质因子个数 \( k=2 \)），故 \( \mu(6) = (-1)^2 = 1 \)。
  - \( x = 12 = 2^2 \times 3 \)（含平方因子 \( 2^2 \)），故 \( \mu(12) = 0 \)。


#### 2. 莫比乌斯推导公式（单位函数与卷积）
单位函数 \( \varepsilon(n) \) 定义为“真值函数”：
\[
\varepsilon(n) = [n=1] =
\begin{cases}
1, & n = 1 \\
0, & n \neq 1
\end{cases}
\]
单位函数与**常数函数 \( I(n)=1 \)**、莫比乌斯函数的狄利克雷卷积满足：
\[
\varepsilon = I * \mu \quad \text{即} \quad \varepsilon(n) = \sum_{d \mid n} \mu(d)
\]
这表明：对任意 \( n \)，其所有因子的莫比乌斯函数和仅当 \( n=1 \) 时为 1，否则为 0。


#### 3. 莫比乌斯反演核心公式
若两个数论函数 \( f(n) \) 和 \( g(n) \) 满足**因子和关系**：
\[
g(n) = \sum_{d \mid n} f(d)
\]
则可通过莫比乌斯反演得到 \( f(n) \) 的表达式：
\[
f(n) = \sum_{d \mid n} g(d) \cdot \mu\left( \frac{n}{d} \right) = \sum_{d \mid n} \mu(d) \cdot g\left( \frac{n}{d} \right)
\]

用**狄利克雷卷积**的语言描述，上述关系等价于：
若 \( g = f * I \)（即 \( g(n) = \sum_{d \mid n} f(d) \)），则 \( f = g * \mu \)（即 \( f(n) = \sum_{d \mid n} g(d) \mu\left( \frac{n}{d} \right) \)），反之亦然。